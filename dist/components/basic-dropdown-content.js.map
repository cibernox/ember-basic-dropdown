{"version":3,"file":"basic-dropdown-content.js","sources":["../../src/components/basic-dropdown-content.gts"],"sourcesContent":["import { action } from '@ember/object';\nimport Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { getScrollParent } from '../utils/calculate-position.ts';\nimport {\n  distributeScroll,\n  getAvailableScroll,\n  getScrollDeltas,\n} from '../utils/scroll-helpers.ts';\nimport hasMoved from '../utils/has-moved.ts';\nimport { isTesting } from '@embroider/macros';\nimport { modifier } from 'ember-modifier';\nimport { element } from 'ember-element-helper';\nimport { or } from 'ember-truth-helpers';\nimport style from 'ember-style-modifier';\nimport { on } from '@ember/modifier';\nimport { fn } from '@ember/helper';\nimport { hash } from '@ember/helper';\nimport type {\n  Dropdown,\n  TRootEventType,\n  HorizontalPosition,\n  VerticalPosition,\n} from '../types.ts';\n\nexport interface BasicDropdownContentSignature {\n  Element: HTMLElement;\n  Args: {\n    animationEnabled?: boolean;\n    transitioningInClass?: string;\n    transitionedInClass?: string;\n    transitioningOutClass?: string;\n    isTouchDevice?: boolean;\n    destination?: string;\n    destinationElement?: HTMLElement | null;\n    dropdown?: Dropdown;\n    renderInPlace?: boolean;\n    preventScroll?: boolean | undefined;\n    rootEventType?: TRootEventType;\n    top?: string | undefined;\n    left?: string | undefined;\n    right?: string | undefined;\n    width?: string | undefined;\n    height?: string | undefined;\n    otherStyles?: Record<string, string | number | undefined>;\n    hPosition?: HorizontalPosition | null;\n    vPosition?: VerticalPosition | null;\n    dir?: string;\n    defaultClass?: string;\n    overlay?: boolean;\n    htmlTag?: keyof HTMLElementTagNameMap;\n    onFocusIn?: (dropdown?: Dropdown, event?: FocusEvent) => void;\n    onFocusOut?: (dropdown?: Dropdown, event?: FocusEvent) => void;\n    onMouseEnter?: (dropdown?: Dropdown, event?: MouseEvent) => void;\n    onMouseLeave?: (dropdown?: Dropdown, event?: MouseEvent) => void;\n    shouldReposition?: (\n      mutations: MutationRecord[],\n      dropdown?: Dropdown,\n    ) => boolean;\n  };\n  Blocks: {\n    default: [];\n  };\n}\n\ntype RootMouseDownHandler = (ev: MouseEvent | TouchEvent) => void;\n\nexport default class BasicDropdownContent extends Component<BasicDropdownContentSignature> {\n  transitioningInClass =\n    this.args.transitioningInClass || 'ember-basic-dropdown--transitioning-in';\n  transitionedInClass =\n    this.args.transitionedInClass || 'ember-basic-dropdown--transitioned-in';\n  transitioningOutClass =\n    this.args.transitioningOutClass ||\n    'ember-basic-dropdown--transitioning-out';\n  isTouchDevice =\n    this.args.isTouchDevice || Boolean(!!window && 'ontouchstart' in window);\n  dropdownId = `ember-basic-dropdown-content-${this.args.dropdown?.uniqueId}`;\n  private touchMoveEvent: TouchEvent | undefined;\n  private handleRootMouseDown?: RootMouseDownHandler;\n  private scrollableAncestors: Element[] = [];\n  private mutationObserver: MutationObserver | undefined;\n  private rootElement: HTMLElement | undefined;\n  @tracked private _contentWormhole?: Element;\n  @tracked animationClass = this.transitioningInClass;\n\n  get destinationElement(): Element | null {\n    if (this.args.destinationElement) {\n      return this.args.destinationElement;\n    }\n\n    if (!this.args.destination) {\n      return null;\n    }\n\n    const element = document.getElementById(this.args.destination);\n\n    if (element) {\n      return element;\n    }\n\n    if (this._contentWormhole) {\n      return (\n        this._contentWormhole.getRootNode() as HTMLElement\n      )?.querySelector('#' + this.args.destination);\n    }\n\n    return null;\n  }\n\n  get animationEnabled(): boolean {\n    const { animationEnabled: animationEnabledArg = true } = this.args;\n\n    return animationEnabledArg && !isTesting();\n  }\n\n  get positionStyles(): Record<string, string> {\n    const style: Record<string, string> = {};\n    if (this.args.top !== undefined) {\n      style['top'] = this.args.top;\n    }\n    if (this.args.left !== undefined) {\n      style['left'] = this.args.left;\n    }\n    if (this.args.right !== undefined) {\n      style['right'] = this.args.right;\n    }\n    if (this.args.width !== undefined) {\n      style['width'] = this.args.width;\n    }\n    if (this.args.height !== undefined) {\n      style['height'] = this.args.height;\n    }\n    return style;\n  }\n\n  /**\n   * Allows similair behaviour to `ember-composable-helpers`' `optional` helper.\n   * Avoids adding extra dependencies.\n   * Can be removed when the template `V1` compatability event handlers are removed.\n   *\n   * @see https://github.com/cibernox/ember-basic-dropdown/issues/498\n   * @memberof BasicDropdownContent\n   */\n  noop(): void {}\n\n  registerDropdownContentWormhole = modifier(\n    (dropdownContentWormhole: Element) => {\n      this._contentWormhole = dropdownContentWormhole;\n    },\n  );\n\n  respondToEvents = modifier(\n    (dropdownElement: Element): (() => void) => {\n      if (this.args.dropdown?.actions?.registerDropdownElement) {\n        this.args.dropdown.actions.registerDropdownElement(\n          dropdownElement as HTMLElement,\n        );\n      }\n\n      const selector = `[data-ebd-id=${this.args.dropdown?.uniqueId}-trigger]`;\n      let triggerElement: HTMLElement | null = null;\n      if (\n        typeof this.args.dropdown?.actions?.getTriggerElement === 'function'\n      ) {\n        triggerElement = this.args.dropdown?.actions?.getTriggerElement();\n      }\n      if (!triggerElement) {\n        triggerElement = document.querySelector(selector) as HTMLElement;\n      }\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      this.handleRootMouseDown = (e: MouseEvent | TouchEvent): any => {\n        const target = (e.composedPath?.()[0] || e.target) as Element;\n        if (target === null) return;\n        if (\n          hasMoved(e as TouchEvent, this.touchMoveEvent) ||\n          dropdownElement.contains(target) ||\n          (triggerElement && triggerElement.contains(target))\n        ) {\n          this.touchMoveEvent = undefined;\n          return;\n        }\n\n        if (dropdownIsValidParent(triggerElement, target, this.dropdownId)) {\n          this.touchMoveEvent = undefined;\n          return;\n        }\n\n        if (this.args.dropdown?.actions?.close) {\n          this.args.dropdown.actions.close(e, true);\n        }\n      };\n      document.addEventListener(\n        this.args.rootEventType || 'click',\n        this.handleRootMouseDown,\n        true,\n      );\n\n      // We need to register closing event on shadow dom element, otherwise all clicks inside a shadow dom are not closing the dropdown\n      // In additional store the rootElement for outside clicks (ensure that we do removeEventListener on correct element)\n      if (\n        this._contentWormhole &&\n        this._contentWormhole.getRootNode() instanceof ShadowRoot\n      ) {\n        this.rootElement = this._contentWormhole.getRootNode() as HTMLElement;\n      } else {\n        this.rootElement = undefined;\n      }\n\n      if (this.rootElement) {\n        this.rootElement.addEventListener(\n          this.args.rootEventType || 'click',\n          this.handleRootMouseDown,\n          true,\n        );\n      }\n\n      window.addEventListener('resize', this.repositionBound);\n      window.addEventListener('orientationchange', this.repositionBound);\n\n      if (this.isTouchDevice) {\n        document.addEventListener(\n          'touchstart',\n          this.touchStartHandlerBound,\n          true,\n        );\n        document.addEventListener('touchend', this.handleRootMouseDown, true);\n\n        if (this.rootElement) {\n          this.rootElement.addEventListener(\n            'touchstart',\n            this.touchStartHandlerBound,\n            true,\n          );\n          this.rootElement.addEventListener(\n            'touchend',\n            this.handleRootMouseDown,\n            true,\n          );\n        }\n      }\n      if (\n        triggerElement !== null &&\n        !(triggerElement.getRootNode() instanceof ShadowRoot)\n      ) {\n        this.scrollableAncestors = getScrollableAncestors(triggerElement);\n      }\n      this.addScrollHandling(dropdownElement);\n      return () => {\n        this.removeGlobalEvents();\n        this.removeScrollHandling();\n        this.scrollableAncestors = [];\n\n        document.removeEventListener(\n          this.args.rootEventType || 'click',\n          this.handleRootMouseDown as RootMouseDownHandler,\n          true,\n        );\n\n        if (this.rootElement) {\n          this.rootElement.removeEventListener(\n            this.args.rootEventType || 'click',\n            this.handleRootMouseDown as RootMouseDownHandler,\n            true,\n          );\n        }\n\n        if (this.isTouchDevice) {\n          document.removeEventListener(\n            'touchstart',\n            this.touchStartHandlerBound,\n            true,\n          );\n          document.removeEventListener(\n            'touchend',\n            this.handleRootMouseDown as RootMouseDownHandler,\n            true,\n          );\n\n          if (this.rootElement) {\n            this.rootElement.removeEventListener(\n              'touchstart',\n              this.touchStartHandlerBound,\n              true,\n            );\n            this.rootElement.removeEventListener(\n              'touchend',\n              this.handleRootMouseDown as RootMouseDownHandler,\n              true,\n            );\n          }\n        }\n      };\n    },\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    { eager: false },\n  );\n\n  initiallyReposition = modifier(\n    () => {\n      // Escape autotracking frame and avoid backtracking re-render\n      void Promise.resolve().then(() => {\n        this.args.dropdown?.actions.reposition();\n      });\n    },\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    { eager: false },\n  );\n\n  animateInAndOut = modifier(\n    (dropdownElement: Element): (() => void) => {\n      if (!this.animationEnabled) return () => {};\n      waitForAnimations(dropdownElement, () => {\n        this.animationClass = this.transitionedInClass;\n      });\n      return () => {\n        if (!this.animationEnabled) return;\n        let parentElement =\n          dropdownElement.parentElement ?? this.destinationElement;\n        if (parentElement === null) return;\n        if (this.args.renderInPlace) {\n          parentElement = parentElement.parentElement;\n        }\n        if (parentElement === null) return;\n        const clone = dropdownElement.cloneNode(true) as Element;\n        clone.id = `${clone.id}--clone`;\n        clone.classList.remove(...this.transitioningInClass.split(' '));\n        clone.classList.add(...this.transitioningOutClass.split(' '));\n        parentElement.appendChild(clone);\n        this.animationClass = this.transitioningInClass;\n        waitForAnimations(clone, function () {\n          (parentElement as HTMLElement).removeChild(clone);\n        });\n      };\n    },\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    { eager: false },\n  );\n\n  observeMutations = modifier(\n    (dropdownElement: Element): (() => void) => {\n      this.mutationObserver = new MutationObserver((mutations) => {\n        let shouldReposition = mutations.some(\n          (record: MutationRecord) =>\n            containsRelevantMutation(record.addedNodes) ||\n            containsRelevantMutation(record.removedNodes),\n        );\n\n        if (shouldReposition && this.args.shouldReposition) {\n          shouldReposition = this.args.shouldReposition(\n            mutations,\n            this.args.dropdown,\n          );\n        }\n\n        if (shouldReposition) {\n          this.reposition();\n        }\n      });\n      this.mutationObserver.observe(dropdownElement, {\n        childList: true,\n        subtree: true,\n      });\n      return () => {\n        if (this.mutationObserver !== undefined) {\n          this.mutationObserver.disconnect();\n          this.mutationObserver = undefined;\n        }\n      };\n    },\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    { eager: false },\n  );\n\n  @action\n  touchStartHandler(): void {\n    document.addEventListener('touchmove', this.touchMoveHandlerBound, true);\n\n    if (\n      this._contentWormhole &&\n      this._contentWormhole.getRootNode() instanceof ShadowRoot\n    ) {\n      const rootElement = this._contentWormhole.getRootNode() as HTMLElement;\n      rootElement.addEventListener(\n        'touchmove',\n        this.touchMoveHandlerBound,\n        true,\n      );\n    }\n  }\n\n  @action\n  touchMoveHandler(e: TouchEvent): void {\n    this.touchMoveEvent = e;\n    document.removeEventListener('touchmove', this.touchMoveHandlerBound, true);\n\n    if (\n      this._contentWormhole &&\n      this._contentWormhole.getRootNode() instanceof ShadowRoot\n    ) {\n      const rootElement = this._contentWormhole.getRootNode() as HTMLElement;\n      rootElement.removeEventListener(\n        'touchmove',\n        this.touchMoveHandlerBound,\n        true,\n      );\n    }\n  }\n\n  @action\n  reposition(): void {\n    if (!this.args.dropdown) {\n      return;\n    }\n\n    this.args.dropdown.actions.reposition();\n  }\n\n  @action\n  removeGlobalEvents(): void {\n    window.removeEventListener('resize', this.repositionBound);\n    window.removeEventListener('orientationchange', this.repositionBound);\n  }\n\n  touchMoveHandlerBound = (e: TouchEvent) => this.touchMoveHandler(e);\n  repositionBound = () => this.reposition();\n  touchStartHandlerBound = () => this.touchStartHandler();\n\n  // Methods\n  addScrollHandling(dropdownElement: Element): void {\n    if (this.args.preventScroll === true) {\n      const wheelHandler = (event: WheelEvent) => {\n        const target = (event.composedPath?.()[0] || event.target) as Element;\n        if (target === null) return;\n        if (\n          dropdownElement.contains(target) ||\n          dropdownElement === event.target\n        ) {\n          // Discover the amount of scrollable canvas that is within the dropdown.\n          const availableScroll = getAvailableScroll(target, dropdownElement);\n\n          // Calculate what the event's desired change to that scrollable canvas is.\n          let { deltaX, deltaY } = getScrollDeltas(event);\n\n          // If the consequence of the wheel action would result in scrolling beyond\n          // the scrollable canvas of the dropdown, call preventDefault() and clamp\n          // the value of the delta to the available scroll size.\n          if (deltaX < availableScroll.deltaXNegative) {\n            deltaX = availableScroll.deltaXNegative;\n            event.preventDefault();\n          } else if (deltaX > availableScroll.deltaXPositive) {\n            deltaX = availableScroll.deltaXPositive;\n            event.preventDefault();\n          } else if (deltaY < availableScroll.deltaYNegative) {\n            deltaY = availableScroll.deltaYNegative;\n            event.preventDefault();\n          } else if (deltaY > availableScroll.deltaYPositive) {\n            deltaY = availableScroll.deltaYPositive;\n            event.preventDefault();\n          }\n\n          // Add back in the default behavior for the two good states that the above\n          // `preventDefault()` code will break.\n          // - Two-axis scrolling on a one-axis scroll container\n          // - The last relevant wheel event if the scroll is overshooting\n\n          // Also, don't attempt to do this if both of `deltaX` or `deltaY` are 0.\n          if (event.defaultPrevented && (deltaX || deltaY)) {\n            distributeScroll(deltaX, deltaY, target, dropdownElement);\n          }\n        } else {\n          // Scrolling outside of the dropdown is prohibited.\n          event.preventDefault();\n        }\n      };\n      document.addEventListener('wheel', wheelHandler, {\n        capture: true,\n        passive: false,\n      });\n\n      if (\n        this._contentWormhole &&\n        this._contentWormhole.getRootNode() instanceof ShadowRoot\n      ) {\n        const rootElement = this._contentWormhole.getRootNode() as HTMLElement;\n        rootElement.addEventListener('wheel', wheelHandler, {\n          capture: true,\n          passive: false,\n        });\n      }\n\n      this.removeScrollHandling = () => {\n        document.removeEventListener('wheel', wheelHandler, { capture: true });\n\n        if (\n          this._contentWormhole &&\n          this._contentWormhole.getRootNode() instanceof ShadowRoot\n        ) {\n          const rootElement =\n            this._contentWormhole.getRootNode() as HTMLElement;\n          rootElement.removeEventListener('wheel', wheelHandler, {\n            capture: true,\n          });\n        }\n      };\n    } else {\n      this.addScrollEvents();\n      this.removeScrollHandling = this.removeScrollEvents.bind(this);\n    }\n  }\n\n  // Assigned at runtime to ensure that changes to the `preventScroll` property\n  // don't result in not cleaning up after ourselves.\n  removeScrollHandling(): void {}\n\n  // These two functions wire up scroll handling if `preventScroll` is false.\n  // These trigger reposition of the dropdown.\n  addScrollEvents(): void {\n    window.addEventListener('scroll', this.repositionBound);\n    this.scrollableAncestors.forEach((el) => {\n      el.addEventListener('scroll', this.repositionBound);\n    });\n  }\n\n  removeScrollEvents(): void {\n    window.removeEventListener('scroll', this.repositionBound);\n    this.scrollableAncestors.forEach((el) => {\n      el.removeEventListener('scroll', this.repositionBound);\n    });\n  }\n\n  <template>\n    {{#if @dropdown.isOpen}}\n      <div\n        class=\"ember-basic-dropdown-content-wormhole-origin\"\n        {{this.registerDropdownContentWormhole}}\n      >\n        {{#if @renderInPlace}}\n          {{#if @overlay}}\n            <div class=\"ember-basic-dropdown-overlay\"></div>\n          {{/if}}\n\n          {{#let (element (or @htmlTag \"div\")) as |OptionalTag|}}\n            <OptionalTag\n              id={{this.dropdownId}}\n              class=\"ember-basic-dropdown-content ember-basic-dropdown-content--{{@hPosition}}\n                ember-basic-dropdown-content--{{@vPosition}}\n                {{this.animationClass}}{{if\n                  @renderInPlace\n                  ' ember-basic-dropdown-content--in-place'\n                }}\n                {{@defaultClass}}\"\n              dir={{@dir}}\n              ...attributes\n              {{style @otherStyles this.positionStyles}}\n              {{this.respondToEvents}}\n              {{this.initiallyReposition}}\n              {{this.observeMutations}}\n              {{this.animateInAndOut}}\n              {{on \"focusin\" (fn (or @onFocusIn this.noop) @dropdown)}}\n              {{on \"focusout\" (fn (or @onFocusOut this.noop) @dropdown)}}\n              {{on \"mouseenter\" (fn (or @onMouseEnter this.noop) @dropdown)}}\n              {{on \"mouseleave\" (fn (or @onMouseLeave this.noop) @dropdown)}}\n              {{! V1 compatibility - See #498 }}\n            >\n              {{yield}}\n            </OptionalTag>\n          {{/let}}\n        {{else if this.destinationElement}}\n          {{#in-element this.destinationElement insertBefore=null}}\n            {{#if @overlay}}\n              <div class=\"ember-basic-dropdown-overlay\"></div>\n            {{/if}}\n\n            {{#let (element (or @htmlTag \"div\")) as |OptionalTag|}}\n              <OptionalTag\n                id={{this.dropdownId}}\n                class=\"ember-basic-dropdown-content ember-basic-dropdown-content--{{@hPosition}}\n                  ember-basic-dropdown-content--{{@vPosition}}\n                  {{this.animationClass}}{{if\n                    @renderInPlace\n                    ' ember-basic-dropdown-content--in-place'\n                  }}\n                  {{@defaultClass}}\"\n                dir={{@dir}}\n                ...attributes\n                {{style @otherStyles this.positionStyles}}\n                {{this.respondToEvents}}\n                {{this.initiallyReposition}}\n                {{this.observeMutations}}\n                {{this.animateInAndOut}}\n                {{on \"focusin\" (fn (or @onFocusIn this.noop) @dropdown)}}\n                {{on \"focusout\" (fn (or @onFocusOut this.noop) @dropdown)}}\n                {{on \"mouseenter\" (fn (or @onMouseEnter this.noop) @dropdown)}}\n                {{on \"mouseleave\" (fn (or @onMouseLeave this.noop) @dropdown)}}\n                {{! V1 compatibility - See #498 }}\n              >\n                {{yield}}\n              </OptionalTag>\n            {{/let}}\n          {{/in-element}}\n        {{/if}}\n      </div>\n    {{else}}\n      <div\n        id={{this.dropdownId}}\n        class=\"ember-basic-dropdown-content-placeholder\"\n        {{style (hash display=\"none\")}}\n      ></div>\n    {{/if}}\n  </template>\n}\n\nfunction containsRelevantMutation(nodeList: NodeList): boolean {\n  for (let i = 0; i < nodeList.length; i++) {\n    const node = nodeList[i];\n    if (\n      node !== undefined &&\n      node.nodeName !== '#comment' &&\n      !(node.nodeName === '#text' && node.nodeValue === '')\n    ) {\n      return true;\n    }\n  }\n  return false;\n}\n\n// All ancestors with scroll (except the BODY, which is treated differently)\nfunction getScrollableAncestors(triggerElement: Element): Element[] {\n  const scrollableAncestors = [];\n  if (triggerElement) {\n    const parent = triggerElement.parentNode;\n    if (parent !== null) {\n      let nextScrollable: Element | undefined = getScrollParent(\n        parent as Element,\n      );\n      while (\n        nextScrollable &&\n        nextScrollable.tagName.toUpperCase() !== 'BODY' &&\n        nextScrollable.tagName.toUpperCase() !== 'HTML'\n      ) {\n        scrollableAncestors.push(nextScrollable);\n        const nextParent = nextScrollable.parentNode;\n        if (nextParent === null) {\n          nextScrollable = undefined;\n        } else {\n          nextScrollable = getScrollParent(nextParent as Element);\n        }\n      }\n    }\n  }\n  return scrollableAncestors;\n}\n\nfunction closestContent(el: Element): Element | null {\n  while (\n    el &&\n    (!el.classList || !el.classList.contains('ember-basic-dropdown-content'))\n  ) {\n    if (el.parentElement === null) return null;\n    el = el.parentElement;\n  }\n  return el;\n}\n\nfunction waitForAnimations(element: Element, callback: () => void): void {\n  window.requestAnimationFrame(function () {\n    const computedStyle = window.getComputedStyle(element);\n    if (\n      computedStyle.animationName !== 'none' &&\n      computedStyle.animationPlayState === 'running'\n    ) {\n      const eventCallback = function () {\n        element.removeEventListener('animationend', eventCallback);\n        callback();\n      };\n      element.addEventListener('animationend', eventCallback);\n    } else {\n      callback();\n    }\n  });\n}\n\n/**\n * Evaluates if the given element is in a dropdown or any of its parent dropdowns.\n *\n * @param {any} owner\n * @param {HTMLElement} el\n * @param {String} dropdownId\n */\nfunction dropdownIsValidParent(\n  triggerElement: HTMLElement | null,\n  el: Element,\n  dropdownId: string,\n): boolean {\n  const closestDropdown = closestContent(el);\n  if (closestDropdown === null) {\n    return false;\n  } else {\n    const closestAttrId = closestDropdown.getAttribute('id') ?? '';\n    const selector = `[aria-controls=${closestAttrId}]`;\n    const trigger =\n      document.querySelector(selector) ??\n      (triggerElement?.getRootNode() as HTMLElement)?.querySelector(selector);\n    if (trigger === null) return false;\n    const parentDropdown = closestContent(trigger);\n    if (parentDropdown === null) return false;\n    const parentAttrId = parentDropdown.getAttribute('id') ?? '';\n    return (\n      (parentDropdown && parentAttrId === dropdownId) ||\n      dropdownIsValidParent(triggerElement, parentDropdown, dropdownId)\n    );\n  }\n}\n"],"names":["BasicDropdownContent","Component","transitioningInClass","args","transitionedInClass","transitioningOutClass","isTouchDevice","Boolean","window","dropdownId","dropdown","uniqueId","touchMoveEvent","handleRootMouseDown","scrollableAncestors","mutationObserver","rootElement","g","prototype","tracked","i","void 0","destinationElement","destination","element","document","getElementById","_contentWormhole","getRootNode","querySelector","animationEnabled","animationEnabledArg","isTesting","positionStyles","style","top","undefined","left","right","width","height","noop","registerDropdownContentWormhole","modifier","dropdownContentWormhole","respondToEvents","dropdownElement","actions","registerDropdownElement","selector","triggerElement","getTriggerElement","e","target","composedPath","hasMoved","contains","dropdownIsValidParent","close","addEventListener","rootEventType","ShadowRoot","repositionBound","touchStartHandlerBound","getScrollableAncestors","addScrollHandling","removeGlobalEvents","removeScrollHandling","removeEventListener","eager","initiallyReposition","Promise","resolve","then","reposition","animateInAndOut","waitForAnimations","animationClass","parentElement","renderInPlace","clone","cloneNode","id","classList","remove","split","add","appendChild","removeChild","observeMutations","MutationObserver","mutations","shouldReposition","some","record","containsRelevantMutation","addedNodes","removedNodes","observe","childList","subtree","disconnect","touchStartHandler","touchMoveHandlerBound","n","action","touchMoveHandler","preventScroll","wheelHandler","event","availableScroll","getAvailableScroll","deltaX","deltaY","getScrollDeltas","deltaXNegative","preventDefault","deltaXPositive","deltaYNegative","deltaYPositive","defaultPrevented","distributeScroll","capture","passive","addScrollEvents","removeScrollEvents","bind","forEach","el","setComponentTemplate","precompileTemplate","strictMode","scope","or","on","fn","hash","nodeList","length","node","nodeName","nodeValue","parent","parentNode","nextScrollable","getScrollParent","tagName","toUpperCase","push","nextParent","closestContent","callback","requestAnimationFrame","computedStyle","getComputedStyle","animationName","animationPlayState","eventCallback","closestDropdown","closestAttrId","getAttribute","trigger","parentDropdown","parentAttrId"],"mappings":"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"}